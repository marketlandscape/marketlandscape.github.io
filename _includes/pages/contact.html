{% include t.html %}

{% assign lang = page.lang | default: "en" %}

{% if lang == "en" %}
  {% assign thanks_url = "/contact/thanks/" %}
{% else %}
  {% assign thanks_url = "/" | append: lang | append: "/contact/thanks/" %}
{% endif %}

<h1>{{ t.contact.title | default: "Contact" }}</h1>

<style>
  .contact-form{
    max-width: 520px;
  }

  .contact-form label{
    display: block;
    margin-bottom: 18px;
    font-size: 0.9rem;
  }

  .contact-form input,
  .contact-form textarea{
    width: 100%;
    padding: 10px 12px;
    margin-top: 6px;
    font-size: 1rem;
    border: 1px solid var(--border);
    border-radius: 6px;
    background: var(--bg);
    color: var(--text);
  }

  .contact-form textarea{
    min-height: 140px;
    resize: vertical;
  }

  .contact-form button{
    margin-top: 8px;
    padding: 10px 18px;
    font-size: 0.95rem;
    border-radius: 6px;
    border: 1px solid var(--border);
    background: transparent;
    color: var(--text);
    cursor: pointer;
  }

  .contact-form button:hover{
    background: rgba(0,0,0,0.03);
  }
</style>

<form id="contactForm"
      class="contact-form"
      action="https://formspree.io/f/mnjpydrq"
      method="POST">

  <label>
    {{ t.contact.name | default: "Name" }}
    <input type="text" name="name" required>
  </label>

  <label>
    {{ t.contact.email | default: "Email" }}
    <input type="email" name="email" required>
  </label>

  <label>
    {{ t.contact.message | default: "Message" }}
    <textarea name="message" required></textarea>
  </label>

  <!-- honeypot -->
  <input type="text" name="_gotcha" style="display:none">

  <button type="submit">
    {{ t.contact.send | default: "Send" }}
  </button>
</form>

<script>
  (function(){
    const form = document.getElementById("contactForm");
    if(!form) return;

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const data = new FormData(form);

      try {
        const res = await fetch(form.action, {
          method: "POST",
          body: data,
          headers: { "Accept": "application/json" }
        });

        if (res.ok) {
          window.location.href = {{ thanks_url | relative_url | jsonify }};
        } else {
          alert({{ t.contact.fail | default: "Submission failed. Please try again." | jsonify }});
        }
      } catch (err) {
        alert({{ t.contact.fail | default: "Submission failed. Please try again." | jsonify }});
      }
    });
  })();
</script>

<p style="margin-top: 24px; font-size: 0.9rem; opacity: 0.8;">
  {{ t.contact.email_before | default: "You can also reach us by email:" }}
  marketlandscape<span style="display:none">x</span>@proton<span style="display:none">y</span>.me
</p>
