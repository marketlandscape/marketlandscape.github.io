<div class="market-mini">
  <div class="market-mini-row">
    <span class="market-mini-label">BTC</span>&thinsp;
    <span id="btcPriceLive" class="market-mini-value">--</span>
  </div>

  <div class="market-mini-row">
    <span class="market-mini-label">ETH</span>&thinsp;
    <span id="ethPriceLive" class="market-mini-value">--</span>
  </div>

  <div id="marketUpdatedLive" class="market-mini-time">
    Updated -- UTC
  </div>
</div>

<script>
(function () {
  async function updateMiniMarket() {
    try {
      const res = await fetch('/data/prices.json', { cache: 'no-store' });
      if (!res.ok) throw new Error('HTTP ' + res.status);
      const j = await res.json();

      const btc = Number(j.btc);
      const eth = Number(j.eth);

      const fmt = new Intl.NumberFormat('en-US', { maximumFractionDigits: 0 });

      const btcEl = document.getElementById('btcPriceLive');
      const ethEl = document.getElementById('ethPriceLive');
      const updEl = document.getElementById('marketUpdatedLive');

      if (btcEl && Number.isFinite(btc)) btcEl.textContent = '$' + fmt.format(btc);
      if (ethEl && Number.isFinite(eth)) ethEl.textContent = '$' + fmt.format(eth);

      if (updEl) {
        const t = j.updated_utc ? j.updated_utc : '-- UTC';
        const src = j.source ? (' Â· ' + j.source) : '';
        updEl.textContent = 'Updated ' + t + src;
      }
    } catch (e) {
      /* silently keep placeholders */
    }
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', updateMiniMarket);
  } else {
    updateMiniMarket();
  }
})();
</script>

<nav class="site-nav">
  <ul class="nav-list">
    {% for item in site.data.nav %}
      <li>
        <a href="{{ item.url | relative_url }}">
          {{ item.title }}
        </a>
      </li>
    {% endfor %}
  </ul>
</nav>
